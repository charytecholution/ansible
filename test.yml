---
  - name: Spin up app container
    hosts: app_servers
    gather_facts: False
    remote_user: ec2-user
    sudo: True
    vars:
      base_image: nexus.techolution.com:8123/d3/ui
      container_name: poc_ui
    tasks:
      - name: Remove the base container if it exists
        local_action: command docker rm -f {{ container_name }}
        failed_when: False
      - name: Start the base container
        local_action: command docker run -d -t -p 4200:4200 --name {{ container_name }} {{ base_image }} bash
      - name: Add the container to the inventory
        add_host: name={{ container_name }}
